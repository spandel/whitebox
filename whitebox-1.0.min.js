$(document).ready(function(){(function(e){e.fn.reverse=[].reverse;e.fn.whitebox=function(t){t=e.extend({},e.fn.whitebox.defaults,t);return this.each(function(){function q(){U()}function R(){U(true)}function U(t,n){var r,s,o,u,a,f;f=0;o=false;u=false;e("#whitebox-"+M+"-next, #whitebox-"+M+"-prev, #whitebox-"+M+"-slider, #whitebox-"+M+"-exit, #whitebox-"+M+"-imgnr").css({visibility:"hidden"});clearTimeout(L);if(!v){v=true;e("#whitebox-"+M+"-img img").css({opacity:0});a=O;o=false;u=false;if(t){a.reverse()}a.each(function(){if(n===f){o=true;r=e(this)}else if(u){r=e(this);u=false}if(e(this).data("url")===d.url&&!o&&n===undefined){o=true;u=true}f++});if(u){r=a.first()}if(t){a.reverse()}var l=r;d=e.extend({},e.fn.whitebox.defaults,l.data());N=l.attr("alt");if(l.data("bgcolor")===undefined){d.bgcolor=C}if(l.data("bgopacity")===undefined){d.bgopacity=k}e("#whitebox-"+M+"-bg").css({backgroundColor:d.bgcolor,opacity:d.bgopacity});if(d.animatetextstyle!=="fade"){e("#whitebox-"+M+"-text-area").css({paddingTop:0,paddingBottom:0,height:0})}if(d.descpos==="top"){var c,h;c=e("#whitebox-"+M+"-img")[0].outerHTML;h=e("#whitebox-"+M+"-text-area")[0].outerHTML;e("#whitebox-"+M+"-innerbox").html("");e("#whitebox-"+M+"-innerbox").append(h+c)}else{var c,h;c=e("#whitebox-"+M+"-img")[0].outerHTML;h=e("#whitebox-"+M+"-text-area")[0].outerHTML;e("#whitebox-"+M+"-innerbox").html("");e("#whitebox-"+M+"-innerbox").append(c+h)}e("#whitebox-"+M+"-img").click(function(e){if(d.clickclose!=="yes"){e.stopPropagation()}if(d.clicknext==="yes"){q()}});i.src=d.url}}function z(){clearTimeout(L);if(d.fadeout==="yes"){e("#whitebox-"+M+"-wrapper").fadeOut(d.closetime,function(){e("#whitebox-"+M+"-wrapper").remove()})}else e("#whitebox-"+M+"-wrapper").remove()}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j;v=true;n=window.innerHeight||e(window).height();r=window.innerWidth||e(window).width();d=t;N=e(this).attr("alt");i=new Image;A=true;M=d.theme;i.onload=function(){P=i.height;H=i.width;B=i.height;j=i.width;T=parseInt(S,10)+parseInt(x,10);if(d.maxheight==="auto"){s=parseInt(n,10)-20-parseInt(h,10)*2-w-T-parseInt(e("#whitebox-"+M+"-slider").height(),10)*2+"px"}else{s=d.maxheight}if(d.maxwidth==="auto"){o=parseInt(r,10)-20-parseInt(p,10)*2+"px"}else{o=d.maxwidth}if(d.fixedwidth){if(j>d.fixedwidth){j=d.fixedwidth}_=d.fixedwidth;o=_}if(d.fixedheight){if(B>d.fixedheight){B=d.fixedheight}D=d.fixedheight;s=D}var t;if(!d.fixedwidth){t=B/P;_=j*t}if(!d.fixedheight){t=j/H;D=B*t}if(d.alt!==undefined&&d.showdesc!=="no"){e("#whitebox-"+M+"-text-area").css({display:"block"});e("#whitebox-"+M+"-text-area").text(d.alt);w=E;T=parseInt(S,10)+parseInt(x,10);e("#whitebox-"+M+"-text-area").css({opacity:0})}else if(N!==undefined&&d.usealt!=="no"&&d.showdesc!=="no"){e("#whitebox-"+M+"-text-area").css({display:"block"});e("#whitebox-"+M+"-text-area").text(N);w=E;T=parseInt(S,10)+parseInt(x,10);e("#whitebox-"+M+"-text-area").css({opacity:0})}else{e("#whitebox-"+M+"-text-area").css({display:"none"});T=0;w=0;d.animatetexttime=0}e("#whitebox-"+M+"-img img").attr("src",i.src).load(function(t){e("#whitebox-"+M+"-img img").css({"max-height":s,"max-width":o});var i;if(!d.fixedwidth){_=e("#whitebox-"+M+"-img img").width()}if(!d.fixedheight){D=e("#whitebox-"+M+"-img img").height()}if(d.autoslide==="yes"&&A){clearTimeout(L);L=setTimeout(function(){q()},d.slidetimer)}v=true;i=n/2-D/2-parseInt(h,10)-parseInt(w,10)/2-T/2;e("#whitebox-"+M+"-text-area").css({"margin-top":0});e("#whitebox-"+M+"-outerbox").animate({top:n/2-D/2-parseInt(h,10)-parseInt(w,10)/2-T/2+"px",left:r/2-_/2-10-parseInt(p,10)+"px",width:parseInt(_,10)+parseInt(c,10)*2+"px",height:u+parseInt(f,10)*2+"px"},d.animateframetime,function(){if(d.showthumbs==="yes"){e("#whitebox-"+M+"-thumbnail-wrapper").css({visibility:"visible"}).animate({opacity:1},d.starttime)}e("#whitebox-"+M+"-img img").animate({opacity:1},d.animateimgtime,function(){if(d.animatetextstyle==="fade"){e("#whitebox-"+M+"-innerbox").css({height:D+w+T});e("#whitebox-"+M+"-outerbox").css({height:D+w+T+parseInt(f,10)*2});e("#whitebox-"+M+"-text-area").animate({opacity:1},d.animatetexttime,function(){v=false;e("#whitebox-"+M+"-next, #whitebox-"+M+"-prev").css({visibility:"visible"});if(d.sliderbtn==="yes"||d.exitbtn==="yes"||d.displayimgnr==="yes"){var t,n;n=parseInt(e("#whitebox-"+M+"-outerbox").css("top"),10);t=parseInt(e("#whitebox-"+M+"-outerbox").css("height"),10)+parseInt(e("#whitebox-"+M+"-outerbox").css("paddingTop"),10)+parseInt(e("#whitebox-"+M+"-outerbox").css("paddingBottom"),10);if(d.sliderbtn==="yes"){if(d.btnanimstyle==="fade"){e("#whitebox-"+M+"-slider").css({visibility:"visible",opacity:0}).animate({opacity:1},d.btnanimtime)}else if(d.btnanimstyle==="none"){e("#whitebox-"+M+"-slider").css({visibility:"visible",opacity:1})}t+=parseInt(e("#whitebox-"+M+"-slider").css("height"),10)*2;n-=parseInt(e("#whitebox-"+M+"-slider").css("height"),10)}else if(d.exitbtn==="yes"){t+=parseInt(e("#whitebox-"+M+"-exit").css("height"),10)*2;n-=parseInt(e("#whitebox-"+M+"-exit").css("height"),10)}else{t+=parseInt(e("#whitebox-"+M+"-imgnr").css("height"),10)*2;n-=parseInt(e("#whitebox-"+M+"-imgnr").css("height"),10)}if(d.exitbtn==="yes"){if(d.btnanimstyle==="fade"){e("#whitebox-"+M+"-exit").css({visibility:"visible",opacity:0}).animate({opacity:1},d.btnanimtime)}else if(d.btnanimstyle==="none"){e("#whitebox-"+M+"-exit").css({visibility:"visible",opacity:1})}}if(d.displayimgnr==="yes"){var r="",i=0,s=1,o=O.size();i=0;O.each(function(){if(e(this).data("url")===d.url){i=s}s++});r=d.imgnrtext.replace("X",i).replace("Y",o);e("#whitebox-"+M+"-imgnr-link span").text(r);if(d.btnanimstyle==="fade"){e("#whitebox-"+M+"-imgnr").css({visibility:"visible",opacity:0}).animate({opacity:1},d.btnanimtime)}else if(d.btnanimstyle==="none"){e("#whitebox-"+M+"-imgnr").css({visibility:"visible",opacity:1})}}e("#whitebox-"+M+"-button-wrapper").css({left:e("#whitebox-"+M+"-outerbox").css("left"),top:n+"px",width:parseInt(e("#whitebox-"+M+"-outerbox").css("width"),10)+parseInt(e("#whitebox-"+M+"-outerbox").css("paddingLeft"),10)+parseInt(e("#whitebox-"+M+"-outerbox").css("paddingRight"),10),height:t+"px"})}})}else{e("#whitebox-"+M+"-text-area").css({opacity:1,height:0,paddingTop:0,paddingBottom:0}).animate({height:w,paddingTop:S,paddingBottom:x},d.animatetexttime,function(){v=false});e("#whitebox-"+M+"-innerbox").css({height:D}).animate({height:D+w+T},d.animatetexttime);e("#whitebox-"+M+"-outerbox").css({height:D}).animate({height:D+w+T+parseInt(f,10)*2},d.animatetexttime,function(){e("#whitebox-"+M+"-next, #whitebox-"+M+"-prev").css({visibility:"visible"});if(d.sliderbtn==="yes"||d.exitbtn==="yes"){var t,n;n=parseInt(e("#whitebox-"+M+"-outerbox").css("top"),10);t=parseInt(e("#whitebox-"+M+"-outerbox").css("height"),10)+parseInt(e("#whitebox-"+M+"-outerbox").css("paddingTop"),10)+parseInt(e("#whitebox-"+M+"-outerbox").css("paddingBottom"),10);if(d.sliderbtn==="yes"){if(d.btnanimstyle==="fade"){e("#whitebox-"+M+"-slider").css({visibility:"visible",opacity:0}).animate({opacity:1},d.btnanimtime)}else if(d.btnanimstyle==="none"){e("#whitebox-"+M+"-slider").css({visibility:"visible",opacity:1})}t+=parseInt(e("#whitebox-"+M+"-slider").css("height"),10)*2;n-=parseInt(e("#whitebox-"+M+"-slider").css("height"),10)}else if(d.exitbtn==="yes"){t+=parseInt(e("#whitebox-"+M+"-exit").css("height"),10)*2;n-=parseInt(e("#whitebox-"+M+"-exit").css("height"),10)}else{t+=parseInt(e("#whitebox-"+M+"-imgnr").css("height"),10)*2;n-=parseInt(e("#whitebox-"+M+"-imgnr").css("height"),10)}if(d.exitbtn==="yes"){if(d.btnanimstyle==="fade"){e("#whitebox-"+M+"-exit").css({visibility:"visible",opacity:0}).animate({opacity:1},d.btnanimtime)}else if(d.btnanimstyle==="none"){e("#whitebox-"+M+"-exit").css({visibility:"visible",opacity:1})}}if(d.displayimgnr==="yes"){var r="",i=0,s=1,o=O.size();i=0;O.each(function(){if(e(this).data("url")===d.url){i=s}s++});r=d.imgnrtext.replace("X",i).replace("Y",o);e("#whitebox-"+M+"-imgnr-link span").text(r);if(d.btnanimstyle==="fade"){e("#whitebox-"+M+"-imgnr").css({visibility:"visible",opacity:0}).animate({opacity:1},d.btnanimtime)}else if(d.btnanimstyle==="none"){e("#whitebox-"+M+"-imgnr").css({visibility:"visible",opacity:1})}}e("#whitebox-"+M+"-button-wrapper").css({left:e("#whitebox-"+M+"-outerbox").css("left"),top:n+"px",width:parseInt(e("#whitebox-"+M+"-outerbox").css("width"),10)+parseInt(e("#whitebox-"+M+"-outerbox").css("paddingLeft"),10)+parseInt(e("#whitebox-"+M+"-outerbox").css("paddingRight"),10),height:t+"px"})}})}if(d.showprevnext!=="no"){var t,n,r=parseInt(e("#whitebox-"+M+"-outerbox").css("top"),10)+parseInt(e("#whitebox-"+M+"-outerbox").css("paddingTop"),10)+parseInt(e("#whitebox-"+M+"-innerbox").css("paddingTop"),10);t=parseInt(e("#whitebox-"+M+"-outerbox").css("left"),10)+parseInt(e("#whitebox-"+M+"-outerbox").css("paddingLeft"),10)+parseInt(e("#whitebox-"+M+"-innerbox").css("paddingLeft"),10)+"px";n=parseInt(e("#whitebox-"+M+"-outerbox").css("left"),10)+parseInt(e("#whitebox-"+M+"-outerbox").css("paddingLeft"),10)+parseInt(e("#whitebox-"+M+"-innerbox").css("paddingLeft"),10)+parseInt(_,10)-parseInt(d.prevnextwidth,10)+"px";if(d.descpos==="top"){r+=w+T}r=r+"px";e("#whitebox-"+M+"-prev, #whitebox-"+M+"-next").css({height:D,position:"fixed",top:r,left:t});e("#whitebox-"+M+"-next").css({left:n})}})});e(this).unbind(t)});e("#whitebox-"+M+"-img img").css({"max-height":s,"max-width":o});var u=e("#whitebox-"+M+"-img img").height();if(d.animatetextstyle==="fade"&&d.descpos!=="bottom-inside"&&d.descpos!=="top-inside"){u=e("#whitebox-"+M+"-img img").height()+w+T}e("#whitebox-"+M+"-img").height(e("#whitebox-"+M+"-img img").height());if((parseInt(i.height,10)<D||e("#whitebox-"+M+"-img img").height()<D)&&(d.fixedheight||d.fixedwidth)){e("#whitebox-"+M+"-img img").css({position:"relative",top:D/2-e("#whitebox-"+M+"-img img").height()/2+"px"});e("#whitebox-"+M+"-text-area").css({position:"relative",top:e("#whitebox-"+M+"-img img").css("top")})}else{e("#whitebox-"+M+"-img img").css({position:"static",top:"auto"});e("#whitebox-"+M+"-text-area").css({position:"static",top:"auto"})}var a=e("#whitebox-"+M+"-img img").width();if(d.fixedwidth||d.fixedheight){a=_;u=D;if(d.showdesc!=="no"&&d.animatetextstyle==="fade"){u+=w+T}}e("#whitebox-"+M+"-innerbox").animate({width:a,height:u},d.animateframetime);e("#whitebox-"+M+"-innerbox").css({height:u})};if(d.url==="srcFromClickedImage"){d.url=e(this).attr("src")}m=new Image;m.onload=function(t){g=m.width;y=m.height;i.src=d.url;e("#whitebox-"+M+"-innerbox").css({"background-position":r/2-10-g/2+"px "+(n/2-y/2)+"px"});e(m).unbind(t)};m.src=d.loadingUrl;var F;if(d.descpos==="top"){F="<div id='whitebox-"+M+"-text-area'></div>"+"<div id='whitebox-"+M+"-img'><img style='opacity:0' /></div>"}else{F="<div id='whitebox-"+M+"-img'><img style='opacity:0' /></div>"+"<div id='whitebox-"+M+"-text-area'></div>"}e("body").append(e("<div id='whitebox-"+M+"-wrapper' style='opacity:0; width:100%;height:100%;'>"+"<div id='whitebox-"+M+"-outerbox'>"+"<div id='whitebox-"+M+"-innerbox'>"+F+"</div>"+"<div id='whitebox-"+M+"-prev'><span>prev</span></div>"+"<div id='whitebox-"+M+"-next'><span>next</span></div>"+"</div>"+"<div id='whitebox-"+M+"-button-wrapper'>"+"<div id='whitebox-"+M+"-slider'><div id='whitebox-"+M+"-slider-link'><span>"+d.sliderstoptext+"</span></div></div>"+"<div id='whitebox-"+M+"-exit'><div id='whitebox-"+M+"-exit-link'><span>"+d.exittext+"</span></div></div>"+"<div id='whitebox-"+M+"-imgnr'><div id='whitebox-"+M+"-imgnr-link'><span>"+d.imgnrtext+"</span></div></div>"+"</div>"+"<div id='whitebox-"+M+"-bg' style='width:100%;height:100%; '></div>"+"<div id='whitebox-"+M+"-thumbnail-wrapper'><div id='whitebox-"+M+"-thumbnails'></div></div>"+"</div>").animate({opacity:1},d.starttime));e("#whitebox-"+M+"-bg").click(function(e){z()});e("#whitebox-"+M+"-slider-link").click(function(t){if(d.autoslide==="yes"&&A){clearTimeout(L);d.autoslide="no";A=false;e("#whitebox-"+M+"-slider-link span").text(d.sliderstarttext)}else{clearTimeout(L);d.autoslide="yes";A=true;e("#whitebox-"+M+"-slider-link span").text(d.sliderstoptext);q()}});if(d.group==="groupbyparent"||d.group===undefined){console.log("grouped by parent!");O=e(this).parent().find(".whitebox")}else{console.log("grouped by group: "+d.group);O=e(".whitebox[data-group='"+d.group+"']")}if(d.showthumbs!=="no"){var I="";O.each(function(){I+="<div class='whitebox-"+M+"-thumb'><img width='"+d.thumbsize+"' src='"+e(this).attr("src")+"'/></div>"});e("#whitebox-"+M+"-thumbnails").html(I);e(".whitebox-"+M+"-thumb").click(function(t){U(false,e(".whitebox-"+M+"-thumb").index(e(this)))})}c=e("#whitebox-"+M+"-innerbox").css("padding-left");f=e("#whitebox-"+M+"-innerbox").css("padding-top");l=e("#whitebox-"+M+"-outerbox").css("padding-left");a=e("#whitebox-"+M+"-outerbox").css("padding-top");p=parseInt(c,10)+parseInt(l,10);h=parseInt(f,10)+parseInt(a,10);w=e("#whitebox-"+M+"-text-area").height();E=w;S=e("#whitebox-"+M+"-text-area").css("padding-top");x=e("#whitebox-"+M+"-text-area").css("padding-bottom");C=e("#whitebox-"+M+"-bg").css("backgroundColor");k=e("#whitebox-"+M+"-bg").css("opacity");if(d.animatetextstyle!=="fade"){e("#whitebox-"+M+"-text-area").css({paddingTop:0,paddingBottom:0,height:0})}if(e(this).data("bgcolor")===undefined){d.bgcolor=C}if(e(this).data("bgopacity")===undefined){d.bgopacity=k}e("#whitebox-"+M+"-prev").click(function(e){R()});e("#whitebox-"+M+"-next").click(function(e){q()});e("#whitebox-"+M+"-img").click(function(e){if(d.clickclose!=="yes"){e.stopPropagation()}if(d.clicknext==="yes"){q()}});e("#whitebox-"+M+"-exit-link").click(function(e){z()});e("#whitebox-"+M+"-prev").css({width:d.prevnextwidth});e("#whitebox-"+M+"-next").css({width:d.prevnextwidth});e("#whitebox-"+M+"-wrapper").css({position:"fixed","z-index":"1000",left:"0",top:"0","text-align":"center"});e("#whitebox-"+M+"-bg").css({position:"fixed",backgroundColor:d.bgcolor,"z-index":"-2",left:"0",top:"0","text-align":"center"});e("#whitebox-"+M+"-outerbox").css({position:"fixed",left:"0",width:"600px",top:"0",height:"400px"});e("#whitebox-"+M+"-innerbox").css({width:600-parseInt(c,10)*2,height:400-parseInt(f,10)*2,"background-image":"url("+d.loadingUrl+")","background-repeat":"no-repeat","background-position":r/2-60+"px "+(n/2-50)+"px","background-attachment":"fixed"});e("#whitebox-"+M+"-img").css({cursor:"pointer"});e("#whitebox-"+M+"-button-wrapper").css({position:"relative",visibility:"hidden",backgroundColor:"rgba(255,0,0,0.5)"});e("#whitebox-"+M+"-slider").css({position:"absolute",visibility:"hidden"});e("#whitebox-"+M+"-slider-link").css({position:"absolute"});e("#whitebox-"+M+"-exit").css({position:"absolute",visibility:"hidden"});e("#whitebox-"+M+"-exit-link").css({position:"absolute"});e("#whitebox-"+M+"-imgnr").css({position:"absolute",visibility:"hidden"});e("#whitebox-"+M+"-imgnr-link").css({position:"absolute"});e("#whitebox-"+M+"-thumbnail-wrapper").css({visibility:"hidden",opacity:0});e(".whitebox-"+M+"-thumb").css({height:e(".whitebox-"+M+"-thumb img").height()});e("#whitebox-"+M+"-outerbox").get(0).style.top=n/2-e("#whitebox-"+M+"-outerbox").height()/2+"px";e("#whitebox-"+M+"-outerbox").get(0).style.left=r/2-e("#whitebox-"+M+"-outerbox").width()/2-10+"px";window.addEventListener("keyup",function(e){if(d.usekeys!="no"){if(e.keyCode===27){console.log("esc pressed");z()}else if(e.keyCode===37){R();console.log("left pressed")}else if(e.keyCode===39){q();console.log("right pressed")}}},false)})};e.fn.whitebox.defaults={url:"srcFromClickedImage",loadingUrl:"img/loading-white.gif",bgcolor:"#000",bgopacity:.5,starttime:300,animateimgtime:300,animateframetime:300,animatetexttime:300,closetime:300,btnanimtime:300,slidetimer:3500,animatetextstyle:"fade",btnanimstyle:"fade",maxheight:"auto",maxwidth:"auto",group:"groupbyparent",usekeys:"yes",usealt:"yes",showdesc:"yes",clicknext:"yes",clickclose:"no",descpos:"bottom",autoslide:"yes",sliderbtn:"yes",fadeout:"yes",exitbtn:"yes",displayimgnr:"yes",exittext:"X",sliderstarttext:"Start slideshow",sliderstoptext:"Stop slideshow",imgnrtext:"Image X of Y",prevnextwidth:"100px",theme:"default",fixedheight:false,fixedwidth:false,showthumbs:"no",thumbsize:"50px"}})(jQuery);$(".whitebox").css({cursor:"pointer"});$(".whitebox").click(function(){$(this).whitebox($(this).data())})})